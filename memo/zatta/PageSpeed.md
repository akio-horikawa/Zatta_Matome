# PageSpeed

Webサイトの応答速度についてメモ。


## PageSpeedInsight

Google提供の測定ツール。

### 速度評価結果

LCP、FID、CLS等の重要な指標（Core Web Vitals）を含む6つの指標に関する評価結果。

| 要素 | 概要                                                     |
| ---- | -------------------------------------------------------- |
| LCP  | 最もサイズが大きいコンテンツの読み込み時間               |
| FID  | ユーザーの操作から反応までの時間（2024/3からINP）        |
| CLS  | ユーザーが予期できないページレイアウトの変更回数、大きさ |
| FCP  | コンテンツが最初に表示されるまでの時間                   |
| INP  | クリック、タップ、キーボード入力に対する反応時間         |
| TTFB | リソ－ス要求後、最初のデータが届くまでの時間             |

ステータスが緑なら問題なし、オレンジなら要改善、赤なら即改善すべき。

特にLCPが重要で、ユーザーが近くする最も大きな要素の読み込み速度を測定する指標であるため、改善すればユーザーにページの表示速度が早いと印象付けることができる。

### パフォーマンス（ラボデータ）

シミュレーション環境下でサイト読み込み分析を行った結果。
ステータスが緑なら問題なし、オレンジなら要改善、赤なら即改善すべき。

| 要素                     | 概要                                                     |
| ------------------------ | -------------------------------------------------------- |
| First Contentful Paint   | コンテンツが最初に表示されるまでの時間                   |
| Largest Contentful Paint | 最もサイズの大きいコンテンツの読み込み時間               |
| Total Blocking Time      | ユーザーの入力がブロックされている合計時間               |
| Cumulative Layout Shift  | ユーザーが予期できないページレイアウトの変更回数、大きさ |
| Speed Index              | ページコンテンツの表示速度                               |

### 速度改善

TBT（Total Blocking Time）
- JavaScriptの実行にかかる時間の低減
  - コードの分割（コンポーネント等を別ファイルに）をすることで必要なコードのみを送信
  - 画像等の最適化を行い、サイズを削減
  - 未使用のコードの削除
  - キャッシュの利用
- メインスレッド処理の最小化
  - サードパーティリソースの選択を必要最小限の機能、コードを送信する。（コードの最適化）
  - 冗長的なスクリプトを定期的に監査、クリーンアップ。
- 過大なDOMサイズの回避
  - 一般的にはDOMノードは必要な時に作成し、不要になった時点で破棄する。
- 最新ブラウザに従来のJavaScriptを配信しない
  - メインスレッドでタスクを長時間実行しない。