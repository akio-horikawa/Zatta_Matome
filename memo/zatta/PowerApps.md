# PowerApps

Microsoft365から利用。SharePoint上にlistを作成して連携、Databaseのようにして利用する。見た目上はコンポーネントを置くのみ。コンポーネント内部に処理を書き込むなどして設定を行う。物によってはOnChange等の設定が行えないものも有る為、工夫が必要。画面遷移と画面間でのデータの受け渡し自体は容易。

## インポートとエクスポート

PowerAppsで作成したアプリは専用のパッケージとしてエクスポート可能。設定を変更しなければ「更新」用のパッケージがダウンロードできるはず。
「更新」用のパッケージはすでにマイアプリに存在するアプリに対して更新を行うものであり、アプリのバックアップ用のものである。
これと別に「新規作成」のパッケージがあり、これはマイアプリ内にインポートしたパッケージのアプリを新しく作成するものである。
どちらのパッケージでもインポート時には、他の機能（SharePointやAutomate）などとの接続を行うアカウントを設定する必要がある。

__とりあえず変更を行う前にバックアップとしてエクスポートすべき。__

PowerAppsは「公開」をしなければ更新者以外からは環境が変化しないが、更新者の環境では自動保存によってかなりの頻度で更新が保存されていく。

#### SharePoint連携

PowerApps内、左メニューからデータ（見た目：ドラム缶）を選択。元データを検索する等して設定。Galleryの設定で紐づけることで画面に表示できる。見た目はコンポーネント（ラベル等）を設定して整える必要がある。
☆データ欄にはClearCollect、Collectで絞り込んだデータが保持される。画面遷移後にデータを渡したいとき等に利用できる。

#### Gallery

データを連携すればギャラリーの種類に応じて並べて表示できる。最初からTitleとSubTitle等の要素が含まれている。NextArrowのOnSelectにはSelect(Parent)が設定されており、クリック時にデータの選択状態を変更してくれる。各データについての編集画面や詳細画面を作成する上で利用できる。

##### Select()

#### 表示・非表示設定

DeleteFlagのような要素を用意しておいて、0,1で削除されているかステータスを管理。 `ClearCollect` 内の `Filter` で条件を設定することで表示する内容を絞り込むことができる。設定方法については以下。

```
ClearCollect(
    絞り込み後のList,
    Filter(
        絞り込み前のList,
        条件
    )
)
```

